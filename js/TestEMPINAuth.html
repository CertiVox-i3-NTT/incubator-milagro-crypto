<!DOCTYPE HTML>
<html>
<head>
<title>JavaScript Test eMPINAuth</title>
</head>
<body>
<h1>JavaScript Test eMPINAuth Example</h1>
<script type="text/javascript" src="DBIG.js"></script>
<script type="text/javascript" src="FP.js"></script>
<script type="text/javascript" src="BIG.js"></script>
<script type="text/javascript" src="ECP.js"></script>
<script type="text/javascript" src="ROM.js"></script>
<script type="text/javascript" src="HASH.js"></script>
<script type="text/javascript" src="RAND.js"></script>
<script type="text/javascript" src="MPINAuth.js"></script>
<script type="text/javascript" src="UTILS.js"></script>
<script type="text/javascript" src="eMPINAuth.js"></script>


<script>
/* test driver and function exerciser for eMPINAuth API Functions */
        function assertEqual(value, expect) {
                if (value !== expect) {
                        return "<span style='color:red;'>" + value + " : expect (" + expect + ")</span>";
                } else {
                        return value;
                }
        }
        function assertEqualObject(value, expect) {
                if (JSON.stringify(value) !== JSON.stringify(expect)) {
                        return "<span style='color:red;'>" + JSON.stringify(value) + " : expect (" + JSON.stringify(expect) + ")</span>";
                } else {
                        return JSON.stringify(value);
                }
        }

	window.document.write("eMpinAuth.getTime() > 0= " + assertEqual(eMpinAuth.getTime() > 0, true) + "<br>");
	window.document.write("<br>");

	originalFunction = MPINAuth.getLocalEntropy;
	MPINAuth.getLocalEntropy = function () {
		return "2d1571a65f710ecf486035238b21065787a980f8bce5a93f770be6c1948fcc08";
	}

	window.document.write("eMpinAuth.authenticate()= " + assertEqualObject(eMpinAuth.authenticate(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		"1578f22893b",
		"040d6f3ee8377941ff0def258395dbd1216fb75154353334553a091400a0bf86880d4bc7c1d2ab1202483775bb8e5d88dce8f731a8c890e33c2b7f875df267a66e",
		"04139b6ae89f0d01b82e92622530ebbc9a90bffad928eb11bf8eec9ee5be6d4cdf00482ea508769610d15c7f1ae534ea4870ba4d2086c928b7eaba065bb0c4290a",
		"0369"
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		U : "041950bf695cb0ab35ded81db32204e37d663062771f0fce286ded73c0a20597420fac43ce0a897f3ded15da22834c64c50127e06e3d34387e0b079ceb2d87b3d5",
		V : "040498b41cd6a3cbf352aae357b177a7674e09244332631cb775e1d0943745c5da04f0d96a79121ec896b3de1b3cea128800de0d5b47ce35a7129462f39709cc54",
		W : "0412c0651e731b5d4b7a6a0a1a52f432d74d6091551c6041d1456a925c81b4d4941c0149c0354993b4ee89305d57478624f10fdde3cde740acc6481595c83d4f30",
		Nonce : "af0e1fcd3e4f9c1a2f36ffeb1c614d5f5c8b8fdac935c3ec8741e4f6365938ef",
		CCT : "1578f22893b"
	}) + "<br>");
	window.document.write("<br>");
	MPINAuth.getLocalEntropy = originalFunction;

    	originalFunction = MPINAuth.getLocalEntropy;
	MPINAuth.getLocalEntropy = function () {
		return "2d1571a65f710ecf486035238b21065787a980f8bce5a93f770be6c1948fcc08";
	}
    	var getXNonceValue = function(){
        	var index = 0;

        	var xNonceValueArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0];

        	return {
            		getByte:function(){
                		value = xNonceValueArray[index];
                		index += 1;
                		return value;
            		}
        	}
    	};

    	originalFunctionInputVariation = eMpinAuth.getPrng_;
    	eMpinAuth.getPrng_ = getXNonceValue;

	window.document.write("eMpinAuth.authenticate(x_ba:[0,success,0])= " + assertEqualObject(eMpinAuth.authenticate(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		"1578f22893b",
		"040d6f3ee8377941ff0def258395dbd1216fb75154353334553a091400a0bf86880d4bc7c1d2ab1202483775bb8e5d88dce8f731a8c890e33c2b7f875df267a66e",
		"04139b6ae89f0d01b82e92622530ebbc9a90bffad928eb11bf8eec9ee5be6d4cdf00482ea508769610d15c7f1ae534ea4870ba4d2086c928b7eaba065bb0c4290a",
		"0369"
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		U : "0420f4945335fb1e2ba59647178511e2c533c28f99abd88299193f0939b98ad44909c99210f4182ac80e228db9ebf684d98a605a8542bd0dfefa6f274ded48b011",
		V : "040488887b5c977ab498df757dd9cfa6c762332566b439f6542cfb56cea5c3fc180cf14e1193449a7729c484a0c0679a20b8135a994748c73c4020a1b21c61b9f4",
		W : "0411beedbff8e1d166555aa8c89c2b09867cbe17973e588c7687a92130cb788b5c1fb8aedd8fd79ac3510cc508cfa128efd57761a05b6195137ffa73c6d211761b",
		Nonce : "0000000000000000000000000000000000000000000000000000000000000000",
		CCT : "1578f22893b"
	}) + "<br>");
	window.document.write("<br>");
	MPINAuth.getLocalEntropy = originalFunction;
    	eMpinAuth.getPrng_ = originalFunctionInputVariation;

    	var getXNonceValue = function(){
        	var index = 0;

        	var xNonceValueArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132];

        	return {
            		getByte:function(){
                		value = xNonceValueArray[index];
                		index += 1;
                		return value;
            		}
        	}
    	};

    	originalFunctionInputVariation = eMpinAuth.getPrng_;
    	eMpinAuth.getPrng_ = getXNonceValue;

	window.document.write("eMpinAuth.authenticate(x_ba:[0,0,success])= " + assertEqualObject(eMpinAuth.authenticate(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		"1578f22893b",
		"040d6f3ee8377941ff0def258395dbd1216fb75154353334553a091400a0bf86880d4bc7c1d2ab1202483775bb8e5d88dce8f731a8c890e33c2b7f875df267a66e",
		"04139b6ae89f0d01b82e92622530ebbc9a90bffad928eb11bf8eec9ee5be6d4cdf00482ea508769610d15c7f1ae534ea4870ba4d2086c928b7eaba065bb0c4290a",
		"0369"
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		U : "0420f4945335fb1e2ba59647178511e2c533c28f99abd88299193f0939b98ad44909c99210f4182ac80e228db9ebf684d98a605a8542bd0dfefa6f274ded48b011",
		V : "040488887b5c977ab498df757dd9cfa6c762332566b439f6542cfb56cea5c3fc180cf14e1193449a7729c484a0c0679a20b8135a994748c73c4020a1b21c61b9f4",
		W : "0411beedbff8e1d166555aa8c89c2b09867cbe17973e588c7687a92130cb788b5c1fb8aedd8fd79ac3510cc508cfa128efd57761a05b6195137ffa73c6d211761b",
		Nonce : "0000000000000000000000000000000000000000000000000000000000000000",
		CCT : "1578f22893b"
	}) + "<br>");
	window.document.write("<br>");
	MPINAuth.getLocalEntropy = originalFunction;
    	eMpinAuth.getPrng_ = originalFunctionInputVariation;

        var getXNonceValue = function(){
        	var index = 0;

        	var xNonceValueArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 , 0, 0, 0, 0, 0, 0, 0, 0, 0];

        	return {
            		getByte:function(){
                		value = xNonceValueArray[index];
                		index += 1;
                		return value;
            		}
        	}
    	};

    	originalFunctionInputVariation = eMpinAuth.getPrng_;
    	eMpinAuth.getPrng_ = getXNonceValue;

	window.document.write("eMpinAuth.authenticate(x_ba:[0,0,0])= " + assertEqualObject(eMpinAuth.authenticate(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		"1578f22893b",
		"040d6f3ee8377941ff0def258395dbd1216fb75154353334553a091400a0bf86880d4bc7c1d2ab1202483775bb8e5d88dce8f731a8c890e33c2b7f875df267a66e",
		"04139b6ae89f0d01b82e92622530ebbc9a90bffad928eb11bf8eec9ee5be6d4cdf00482ea508769610d15c7f1ae534ea4870ba4d2086c928b7eaba065bb0c4290a",
		"0369"
	), []) + "<br>");
	window.document.write("<br>");
	MPINAuth.getLocalEntropy = originalFunction;
    	eMpinAuth.getPrng_ = originalFunctionInputVariation;

	var x_ba = [], n_ba=[];
	x_ba.push(101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132);
	n_ba.push(201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232);
	window.document.write("eMpinAuth.authenticate_det()= " + assertEqualObject(eMpinAuth.authenticate_det(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		"1578f22893b",
		"040d6f3ee8377941ff0def258395dbd1216fb75154353334553a091400a0bf86880d4bc7c1d2ab1202483775bb8e5d88dce8f731a8c890e33c2b7f875df267a66e",
		"04139b6ae89f0d01b82e92622530ebbc9a90bffad928eb11bf8eec9ee5be6d4cdf00482ea508769610d15c7f1ae534ea4870ba4d2086c928b7eaba065bb0c4290a",
		"0369",
		Math.floor(parseInt("1578f22893b", 16) / (3600 * 24 * 1000)),
		BIG.fromBytes(x_ba),
		BIG.fromBytes(n_ba)
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d30372d31332030393a35353a34332e383734313935222c2022757365724944223a2022617a415a30392e2123242526272a2b2f3d3f5e5f607b7c7d7e2d406c6f63616c686f7374222c202273616c74223a20223039636430363936313063333762613163303263326136633538393734666533227d",
		U : "0420f4945335fb1e2ba59647178511e2c533c28f99abd88299193f0939b98ad44909c99210f4182ac80e228db9ebf684d98a605a8542bd0dfefa6f274ded48b011",
		V : "041cfc282099cced8098588554cca4fee8db2c7451cd76f404f1a89665e5c708a0112b471963305aeb7043704233a3040e2da04467a3fe0aa0b74b3f9e06cefa4e",
		W : "0411beedbff8e1d166555aa8c89c2b09867cbe17973e588c7687a92130cb788b5c1fb8aedd8fd79ac3510cc508cfa128efd57761a05b6195137ffa73c6d211761b",
		Nonce : "c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8",
		CCT : "1578f22893b"
	}) + "<br>");
	window.document.write("<br>");

	var x_ba = [], n_ba=[];
	x_ba.push(255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,255, 255, 255);
	n_ba.push(255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,255, 255, 255);
	window.document.write("eMpinAuth.authenticate_det(MpinId:Max, Nonce:Max, x_ba:Max)= " + assertEqualObject(eMpinAuth.authenticate_det(
	"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030353a34353a32352e313233393431222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226666666666666666666666666666666666666666666666666666666666666666227d",
	"158be10d6e1",
		"040bb0bb1b34cca81130cc61c3305d586d13b71cd2140a1bb6a189cb3fb2201aac089b531d74b343201dab4c19d53afb83f5556d766d21c3581a7adadb91d867cc",
		"040e56923c849168e6ec3f3b06a2e63ac4427170fa74002c9a5146e04ff7933a6623066e4dd2a9308bd0d02c5a8d285eed306d7a075f63451b320751c848bf1389",
		"1111",
		Math.floor(parseInt("158be10d6e1", 16) / (3600 * 24 * 1000)),
		BIG.fromBytes(x_ba),
		BIG.fromBytes(n_ba)
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030353a34353a32352e313233393431222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226666666666666666666666666666666666666666666666666666666666666666227d",
		U : "040ba44779a7f376057f357fb07bf7915de53d6d3c16dd82efbbf6b295f1fe473c0ad16462d88e4dba6a09a4bd091afdba3ad2cac275fb9faa4c5ab07bd2d484c6",
		V : "040ecb27f984fc297b0c2d1d6e9568b3382ce9c6960b8df9fdc12570c2034db1a30274852d82ce618a1a274c2c77a4806517eabbdd7a51e9c57c4e0efe8aa98154",
		W : "04202598424d5909460e7f5fc34b7c1bdb17cfcd1237ea66168679937f426e0ceb2162734eac651c980cc5a2a535441dfffa876316e26861ff2d96da8bb65012af",
		Nonce : "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
		CCT : "158be10d6e1"
	}) + "<br>");
	window.document.write("<br>");

	var x_ba = [], n_ba=[];
	x_ba.push(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 1);
	n_ba.push(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0);
	window.document.write("eMpinAuth.authenticate_det(MpinId:Min, Nonce:Min, x_ba:Min)= " + assertEqualObject(eMpinAuth.authenticate_det(
	"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030353a35333a35342e323735323633222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20223030303030303030303030303030303030303030303030303030303030303030227d",
	"158be189d16",
		"04084cc798d17b60c5bb887e98b4935fe4fbd47959220d5b03ab4175a10df6bed91713174ad627bf16dc43e6241f151f41ed7011b5302c841df677e70845b93a13",
		"0401134a4ea2853df04c0bc03e65bc1dc80ac9c8596978611ab996c65eff9610cd06a54631a8366610359913ce6db4f3eb3f84444cba5f71b2f3d3ac54b425a338",
		"1111",
		Math.floor(parseInt("158be189d16", 16) / (3600 * 24 * 1000)),
		BIG.fromBytes(x_ba),
		BIG.fromBytes(n_ba)
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030353a35333a35342e323735323633222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20223030303030303030303030303030303030303030303030303030303030303030227d",
		U : "040e83b73a5edb52cd0e1df703005b3d423ff7855755e794231b033b79ec2d9dac02f8548bbcb195d309a71fdeb3565b2e7452496bea0b073fc509c0938d700fa4",
		V : "040c1771eb1c37933416553ee49930f91c521a8ed8e58a2d160a0fefc8fe1b68a0054bdeaaa7a457bc990376d12e85a34df0e9bd18b19ae06b891511bf70559183",
		W : "0411245f1eccc467eccf6c1c991ad7134283f79e8432626cee5c021ea5b3bd03a00c535b5b983c55f08ca742bad20a6284feedf2563b649f12ee622fe8b18990d8",
		Nonce : "0000000000000000000000000000000000000000000000000000000000000000",
		CCT : "158be189d16"
	}) + "<br>");
	window.document.write("<br>");

	originalFunction = MPINAuth.getLocalEntropy;
	MPINAuth.getLocalEntropy = function () {
		return "2d1571a65f710ecf486035238b21065787a980f8bce5a93f770be6c1948fcc08";
	}

	window.document.write("eMpinAuth.activationCheck()= " + assertEqualObject(eMpinAuth.activationCheck(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		"04085d31ae03beefbbec5dfbfea648033746ac79caf6b3b562047c5c73b10f8fe62275b1b0e4c4ce304aaa6609143baf01e0a3b9810162e393c94ec3b19d7cd1b4"
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		U : "041e578d246b71d00e995cdc4618996f2e6a571ab5ea1f7d406b496a69ff25502605f2d5e426298b86bdc891e4a57c0ae82acbb697b1db70620d3daf6a8f937347",
		V : "0404978d69b3972983fd45e5b85de1717aa93b799faaaa357126d987658f31c7f8006fa7b4eba537b2776b7eaad83dfc1c02e643c628cbbc550bc0cac14735c81a"
	}) + "<br>");
    	window.document.write("<br>");

    	MPINAuth.getLocalEntropy = originalFunction;

    	originalFunction = MPINAuth.getLocalEntropy;
	MPINAuth.getLocalEntropy = function () {
		return "2d1571a65f710ecf486035238b21065787a980f8bce5a93f770be6c1948fcc08";
	}

    	var getXValue = function(){
    		var index = 0;

    		var xVAlueArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

        	return {
        		getByte:function(){
                		value = xVAlueArray[index];
                		index += 1;
                		return value;
            		}
        	}
    	};

    	originalFunctionInputVariation = eMpinAuth.getPrng_;
    	eMpinAuth.getPrng_ = getXValue;

	window.document.write("eMpinAuth.activationCheck(acivation_code:[0,success,0])= " + assertEqualObject(eMpinAuth.activationCheck(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		"04085d31ae03beefbbec5dfbfea648033746ac79caf6b3b562047c5c73b10f8fe62275b1b0e4c4ce304aaa6609143baf01e0a3b9810162e393c94ec3b19d7cd1b4"
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		U : "0408fb64e6ead5ca0199577d229d3befc94bf4a14225d997f7187282fe96b300dd0a7f0b80c54e0e8e3bcdc820c5fbf06be85c20e7c0fcfd7dcf08bc38a5416c50",
		V : "0400724ae5cb1f40af2385c494960d177d44a2a32f5aa90838e29b265c984f81fb1b7fe8476648d00dfea8deb523252642aa4e72bd0b8d1d759c33426b14e46942"
	}) + "<br>");
	window.document.write("<br>");

	MPINAuth.getLocalEntropy = originalFunction;

    	originalFunction = MPINAuth.getLocalEntropy;
	MPINAuth.getLocalEntropy = function () {
		return "2d1571a65f710ecf486035238b21065787a980f8bce5a93f770be6c1948fcc08";
	}
    	eMpinAuth.getPrng_ = originalFunctionInputVariation;

    	var getXValue = function(){
    		var index = 0;

    		var xVAlueArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132]

		return {
            		getByte:function(){
                		value = xVAlueArray[index];
                		index += 1;
                		return value;
            		}
        	}
    	};

    	originalFunctionInputVariation = eMpinAuth.getPrng_;
    	eMpinAuth.getPrng_ = getXValue;

	window.document.write("eMpinAuth.activationCheck(activation_code:[0,0,success])= " + assertEqualObject(eMpinAuth.activationCheck(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		"04085d31ae03beefbbec5dfbfea648033746ac79caf6b3b562047c5c73b10f8fe62275b1b0e4c4ce304aaa6609143baf01e0a3b9810162e393c94ec3b19d7cd1b4"
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		U : "0408fb64e6ead5ca0199577d229d3befc94bf4a14225d997f7187282fe96b300dd0a7f0b80c54e0e8e3bcdc820c5fbf06be85c20e7c0fcfd7dcf08bc38a5416c50",
		V : "0400724ae5cb1f40af2385c494960d177d44a2a32f5aa90838e29b265c984f81fb1b7fe8476648d00dfea8deb523252642aa4e72bd0b8d1d759c33426b14e46942"
	}) + "<br>");
	window.document.write("<br>");

	MPINAuth.getLocalEntropy = originalFunction;

    	originalFunction = MPINAuth.getLocalEntropy;
	MPINAuth.getLocalEntropy = function () {
		return "2d1571a65f710ecf486035238b21065787a980f8bce5a93f770be6c1948fcc08";
	}
    	eMpinAuth.getPrng_ = originalFunctionInputVariation;

    	var getXValue = function(){
    		var index = 0;

   		var xVAlueArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

        	return {
        		getByte:function(){
				value = xVAlueArray[index];
                		index += 1;
                		return value;
            		}
        	}
    	};


    	originalFunctionInputVariation = eMpinAuth.getPrng_;
    	eMpinAuth.getPrng_ = getXValue;

	window.document.write("eMpinAuth.activationCheck(activation_code:[0,0,0])= " + assertEqualObject(eMpinAuth.activationCheck(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		"04085d31ae03beefbbec5dfbfea648033746ac79caf6b3b562047c5c73b10f8fe62275b1b0e4c4ce304aaa6609143baf01e0a3b9810162e393c94ec3b19d7cd1b4"
	), []) + "<br>");
	window.document.write("<br>");

    	MPINAuth.getLocalEntropy = originalFunction;
    	eMpinAuth.getPrng_ = originalFunctionInputVariation;

	var x_ba = [];
	x_ba.push(101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132);
	window.document.write("eMpinAuth.activationCheck_det()= " + assertEqualObject(eMpinAuth.activationCheck_det(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		"04085d31ae03beefbbec5dfbfea648033746ac79caf6b3b562047c5c73b10f8fe62275b1b0e4c4ce304aaa6609143baf01e0a3b9810162e393c94ec3b19d7cd1b4",
		BIG.fromBytes(x_ba)
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030343a33383a35392e303737353235222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226331333933323132343037306165393961653239663364626332323565633133227d",
		U : "0408fb64e6ead5ca0199577d229d3befc94bf4a14225d997f7187282fe96b300dd0a7f0b80c54e0e8e3bcdc820c5fbf06be85c20e7c0fcfd7dcf08bc38a5416c50",
		V : "0400724ae5cb1f40af2385c494960d177d44a2a32f5aa90838e29b265c984f81fb1b7fe8476648d00dfea8deb523252642aa4e72bd0b8d1d759c33426b14e46942"
	}) + "<br>");
	window.document.write("<br>");

	var x_ba = [];
	x_ba.push(255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,255, 255, 255);
	window.document.write("eMpinAuth.activationCheck_det(MpinId:Max, x_ba:Max)= " + assertEqualObject(eMpinAuth.activationCheck_det(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030343a31363a32322e353138313933222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226666666666666666666666666666666666666666666666666666666666666666227d",
		"0423474f80a2158c0dc4c11b82cd07e408d56efd54a25b2c217310a3c2f2e8bb5323e17189f7d47aabe950fdddbfce1dab909dcfae0e411922a9540f3f3bb2a952",
		BIG.fromBytes(x_ba)
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030343a31363a32322e353138313933222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226666666666666666666666666666666666666666666666666666666666666666227d",
		U : "040c48f778964a3eaf54fb44538795ce3df778fd8e29b6583cb73e3d863e3139380f3cfaa9b7f9a48c0ada77bb7da68b7faa94fc46b5af834fd6d6354513b98216",
		V : "0412e06e5b53cad204b765ee70509797b87208d212f1111e03d6b278db2bbcb8361039b9c389f9c016946de574d3df49aadee883109c14e438c1f1b76f8b14e24f"
	}) + "<br>");
	window.document.write("<br>");

	var x_ba = [];
	x_ba.push(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 1);
	window.document.write("eMpinAuth.activationCheck_det(MpinId:Min, x_ba:Min)= " + assertEqualObject(eMpinAuth.activationCheck_det(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030343a33383a30312e313832383530222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20223030303030303030303030303030303030303030303030303030303030303030227d",
		"0411dd12a9bca98426fb036bd3c2d7091860bbdffccc2ba1f0edb299eb28fe9bdc1650906a0b9756725d789cb7d009d050c981064bc548175365d3dfb3a3c35ea4",
		BIG.fromBytes(x_ba)
	), {
		MpinId : "7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31322d30322030343a33383a30312e313832383530222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20223030303030303030303030303030303030303030303030303030303030303030227d",
		U : "0415f4dc516e5e6787ee7ffe92a47a462660a56887de260df8f449ba1b8325ab480f565df2fe9a2001dacc7a928ce279f0b130fd01747103c25c03e786fc796760",
		V : "0423da0a2badfa7120a216d19872a9358ec938aca25778a3a95b4f90ec874f9a26006be88144ed52dbbd61b73a23142c3508f2709bd120894e71701877f54c3060"
	}) + "<br>");
	window.document.write("<br>");

	window.document.write("eMpinAuth.calcClientSecretWithStringPin(isEncode:true)= " + assertEqual(eMpinAuth.calcClientSecretWithStringPin(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030353a32343a34392e313332363834222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226666653265353530313133306565363165626239396465386132376633333839227d",
		"040d14b7e361c52028946bb0c9ba2c7b3c845d205a0d0d6c441ca257ad0624b3c1131810ef3bc5030fb0c1a85b8bc86e950e1d4149ddfe1b45b68852fa0d426b52",
		"0369",
		true
	), "04222d0d3f2c3fde6782f5433a3c51946fea781fb3850cb441da35cec34370c9210fff5f7f13c2b29bb2dccd6972e1e57aa3ef100a41214137a8d1c68f0af4122b") + "<br>");
	window.document.write("<br>");

	window.document.write("eMpinAuth.calcClientSecretWithStringPin(isEncode:false)= " + assertEqual(eMpinAuth.calcClientSecretWithStringPin(
		"7b226d6f62696c65223a20302c2022697373756564223a2022323031362d31302d30352030353a32343a34392e313332363834222c2022757365724944223a2022726f6f74406c6f63616c686f7374222c202273616c74223a20226666653265353530313133306565363165626239396465386132376633333839227d",
		"040d14b7e361c52028946bb0c9ba2c7b3c845d205a0d0d6c441ca257ad0624b3c1131810ef3bc5030fb0c1a85b8bc86e950e1d4149ddfe1b45b68852fa0d426b52",
		"0369",
		false
	), "040af1fb1388102b28c214b041d073d82626af7144d7bab4f37047bb6b8141ebe815004fac9090f80dbef17ca8c86f2b1bf0986b5dd504e1fd213a024b05b2e4e5") + "<br>");
	window.document.write("<br>");
</script>
</body>
</html>
